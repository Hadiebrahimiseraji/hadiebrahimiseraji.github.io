<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø¢Ù‡Ù† Ø¢Ù„Ø§Øª Ù…Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ÛŒ Ù‚Ø§Ø¦Ù…â€ŒØ´Ù‡Ø± | Ù‚ÛŒÙ…Øª Ø±ÙˆØ² Ø¢Ù‡Ù†</title>
  <meta name="description" content="Ø¢Ù‡Ù† Ø¢Ù„Ø§Øª Ù…Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ÛŒ Ø¯Ø± Ù‚Ø§Ø¦Ù…â€ŒØ´Ù‡Ø± - Ù…ÛŒÙ„Ú¯Ø±Ø¯ØŒ ØªÛŒØ±Ø¢Ù‡Ù†ØŒ Ù†Ø¨Ø´ÛŒØŒ Ø§Ø±Ø³Ø§Ù„ Ù‡Ù…Ø§Ù†â€ŒØ±ÙˆØ²." />
  <meta name="author" content="Ø¢Ù‡Ù† Ø¢Ù„Ø§Øª Ù…Ø­Ø³Ù†" />
  <meta name="format-detection" content="telephone=no" />
  
  <!-- Leaflet Map CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    html, body { height: 100%; width: 100%; }
    
    body {
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
      background: #0b1020;
      color: #2b2b2b;
    }

    /* Ù†Ù‚Ø´Ù‡ Ùˆ Ù¾Ø³ Ø²Ù…Ù†Ù‡ */
    #hero-map-wrap {
      position: relative;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      background: linear-gradient(135deg, #070a12 0%, #0b1020 100%);
    }

    #map {
      width: 100%;
      height: 100%;
    }

    /* Ù„Ø§ÛŒÙ‡ Ù…Ø¹Ø±ÙÛŒ Ø§ÙˆÙ„ÛŒÙ‡ */
    #intro-overlay {
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      z-index: 9999;
      background: radial-gradient(circle at 30% 30%, rgba(120, 140, 255, 0.25), transparent 40%),
                  radial-gradient(circle at 70% 70%, rgba(120, 255, 200, 0.18), transparent 40%),
                  linear-gradient(180deg, #070a12, #0b1020);
      color: #fff;
      transition: opacity 400ms ease;
    }

    #intro-overlay.hide {
      opacity: 0;
      pointer-events: none;
    }

    .intro-card {
      text-align: center;
      padding: 28px 24px 24px;
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 18px;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(12px);
      max-width: 360px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25);
    }

    .intro-globe {
      font-size: 56px;
      line-height: 1;
      margin-bottom: 12px;
      display: inline-block;
      animation: floaty 2s ease-in-out infinite;
    }

    @keyframes floaty {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .intro-title {
      font-weight: 800;
      font-size: 20px;
      margin: 0 0 8px;
      color: #ffffff;
    }

    .intro-sub {
      margin: 0;
      font-size: 14px;
      opacity: 0.9;
      color: rgba(255, 255, 255, 0.8);
    }

    /* Ù¾Ø§Ù¾ Ø¢Ù¾ Ù…ØºØ§Ø²Ù‡ */
    .shop-popup {
      width: 240px;
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
    }

    .shop-popup img {
      width: 100%;
      height: 140px;
      object-fit: cover;
      border-radius: 12px;
      display: block;
      margin: 10px 0 12px;
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    .shop-popup .name {
      font-weight: 900;
      margin: 0 0 8px;
      font-size: 16px;
      color: #0b1020;
    }

    .shop-popup .addr {
      margin: 0 0 12px;
      font-size: 13px;
      opacity: 0.75;
      color: #2b2b2b;
    }

    .shop-popup .actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    .shop-popup .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      text-decoration: none;
      padding: 9px 12px;
      border-radius: 10px;
      border: none;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all 250ms ease;
      flex: 1;
      min-height: 36px;
    }

    .shop-popup .btn-primary {
      color: #fff;
      background: #0b1020;
    }

    .shop-popup .btn-primary:hover {
      background: #1a2844;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .shop-popup .btn-secondary {
      color: #0b1020;
      background: #f0f0f0;
      border: 1px solid #ddd;
    }

    .shop-popup .btn-secondary:hover {
      background: #e8e8e8;
      transform: translateY(-2px);
    }

    /* Leaflet Ú†Ø§Ù¾Ù‡ØŒ Ø±Ù†Ú¯Ù‡Ø§ */
    .leaflet-container {
      background: #e5e5e5;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto;
    }

    .leaflet-popup-content-wrapper {
      border-radius: 12px;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.15);
    }

    .leaflet-popup-tip {
      background: white;
    }

    /* Ù…Ø§Ø±Ú©Ø± Ù†ÛŒÙˆÙ…ÙˆØ±ÙÛŒÚ© */
    .leaflet-marker-icon {
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    /* Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒÛŒ Ø²Ø§ÛŒØ± */
    .leaflet-control {
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }

    .leaflet-control-zoom {
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    .leaflet-control-attribution {
      font-size: 11px;
      background: rgba(255, 255, 255, 0.85) !important;
      backdrop-filter: blur(4px);
    }

    /* Ø±ÙØªØ§Ø± Ø­Ø±Ú©Ø§ØªÛŒ Ú©Ù… */
    @media (prefers-reduced-motion: reduce) {
      .intro-globe { animation: none; }
      * { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
    }

    /* Ø¨Ø®Ø´ Ø¨Ø¹Ø¯ÛŒ */
    #main-content {
      display: none;
    }

    #main-content.show {
      display: block;
    }
  </style>
</head>
<body>
  <!-- Ù†Ù‚Ø´Ù‡ Ø¨Ø§ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† -->
  <section id="hero-map-wrap">
    <div id="map" role="application" aria-label="Ù†Ù‚Ø´Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡"></div>

    <div id="intro-overlay">
      <div class="intro-card">
        <div class="intro-globe">ğŸŒ</div>
        <p class="intro-title">Ø¯Ø± Ø­Ø§Ù„ Ù‚ÛŒØ§Ù… Ø§ÛŒØ±Ø§Ù†</p>
        <p class="intro-sub">Ø¢Ù‡Ù† Ø¢Ù„Ø§Øª Ù…Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ÛŒ</p>
      </div>
    </div>
  </section>

  <!-- Ø¨Ø®Ø´ Ø§ØµÙ„ÛŒ (PØ§ÛŒÙ†ØªØ± Ùˆ ØªÙ…Ø§Ø³) -->
  <main id="main-content">
    <!-- Ø§ÛŒÙ†Ø¬Ø§ Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø± Ù‚Ø±Ø§Ø± Ø®ÙˆØ§Ù‡Ù†Ø¯ Ú¯Ø±ÙØª -->
  </main>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <script>
    (() => {
      "use strict";

      /* ============================================================
         ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙØ±ÙˆØ´Ú¯Ø§Ù‡
         ============================================================ */
      const SHOP = {
        name: "Ø¢Ù‡Ù† Ø¢Ù„Ø§Øª Ù…Ø­Ø³Ù† Ù…Ø­Ù…Ø¯ÛŒ",
        address: "Ù‚Ø§Ø¦Ù…â€ŒØ´Ù‡Ø±ØŒ Ù…ÛŒØ¯Ø§Ù† Ø§Ù…Ø§Ù…",
        phone: "0911 328 6812",
        // Ù…Ø®ØªØµØ§Øª Ù‚Ø§Ø¦Ù…â€ŒØ´Ù‡Ø±
        lat: 36.4719,
        lng: 52.8620,
        // Ø¹ÙƒØ³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
        photoUrl: "assets/images/storefront.jpg"
      };

      /* ============================================================
         ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù†Ù‚Ø´Ù‡â€ŒØ´Ù†Ø§Ø³ÛŒ
         ============================================================ */

      const WORLD_VIEW = { lat: 31.5, lng: 54.2, zoom: 4 }; // Ø§ÛŒØ±Ø§Ù†
      const COUNTRY_VIEW = { lat: 36.5, lng: 52.8, zoom: 8 }; // Ù…Ø§Ø²Ù†Ø¯Ø±Ø§Ù†
      const TARGET_ZOOM = 17; // Ø²ÙˆÙ… Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø± Ù„ÙˆÚ©ÛŒØ´Ù†

      const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      const ANIM_DURATION_1 = prefersReducedMotion ? 0.01 : 1.8; // Ø¯Ù†ÛŒØ§ Ø¨Ù‡ Ø§ÛŒØ±Ø§Ù†
      const ANIM_DURATION_2 = prefersReducedMotion ? 0.01 : 1.6; // Ø§ÛŒØ±Ø§Ù† Ø¨Ù‡ Ù„ÙˆÚ©ÛŒØ´Ù†

      // Ø³Ø§Ø®Øª Ù†Ù‚Ø´Ù‡
      const map = L.map("map", {
        zoomControl: true,
        attributionControl: true,
        worldCopyJump: false,
        preferCanvas: true,
        fadeAnimation: false,
        markerZoomAnimation: false
      });

      map.setView([WORLD_VIEW.lat, WORLD_VIEW.lng], WORLD_VIEW.zoom);

      // Tile Layer - OpenStreetMap
      const tiles = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
        minZoom: 2,
        subdomains: "abc",
        keepBuffer: 2,
        updateWhenIdle: true,
        updateWhenZooming: false,
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      // Ù…Ø§Ø±Ú©Ø± Ùˆ Ù¾Ø§Ù¾ Ø¢Ù¾
      const gmapsLink = `https://www.google.com/maps?q=${SHOP.lat},${SHOP.lng}`;
      const waLink = `https://wa.me/989113286812?text=Ø³Ù„Ø§Ù…%2C%20Ø¨Ø±Ø§ÛŒ%20Ø§Ø³ØªØ¹Ù„Ø§Ù…%20Ù‚ÛŒÙ…Øª%20Ø¢Ù‡Ù†%20Ù¾ÛŒØ§Ù…%20Ø¯Ø§Ø¯Ù….`;

      const popupHtml = `
        <div class="shop-popup" dir="rtl">
          <p class="name">${escapeHtml(SHOP.name)}</p>
          <img loading="lazy" decoding="async" src="${escapeAttr(SHOP.photoUrl)}" alt="Ø¹ÙƒØ³ ÙØ±ÙˆØ´Ú¯Ø§Ù‡">
          <p class="addr">ğŸ“„ ${escapeHtml(SHOP.address)}</p>
          <p class="addr" style="margin-bottom: 6px;">&#128222; <span style="direction: ltr; unicode-bidi: embed;">${SHOP.phone}</span></p>
          <div class="actions">
            <a class="btn btn-primary" href="${escapeAttr(gmapsLink)}" target="_blank" rel="noopener">ğŸ“„ Google Maps</a>
            <a class="btn btn-secondary" href="${escapeAttr(waLink)}" target="_blank" rel="noopener">ğŸ’¬ WhatsApp</a>
          </div>
        </div>
      `;

      const marker = L.marker([SHOP.lat, SHOP.lng], { keyboard: false })
        .addTo(map)
        .bindPopup(popupHtml, { maxWidth: 260 });

      /* ============================================================
         Ú©Ø±Ù†ÙˆÙ†Ø´ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø³Ù‡ Ù…Ø±Ø­Ù„Ù‡
         ============================================================ */

      let started = false;
      let step = 0;

      const runAnimation = () => {
        if (started) return;
        started = true;

        // Ù…Ø±Ø­Ù„Ù‡ 1: Ø¯Ù†ÛŒØ§ â†’ Ø§ÛŒØ±Ø§Ù†
        const delay1 = prefersReducedMotion ? 0 : 450;
        setTimeout(() => {
          map.flyTo([COUNTRY_VIEW.lat, COUNTRY_VIEW.lng], COUNTRY_VIEW.zoom, {
            animate: !prefersReducedMotion,
            duration: ANIM_DURATION_1,
            easeLinearity: 0.25
          });

          // Ù…Ø±Ø­Ù„Ù‡ 2: Ø§ÛŒØ±Ø§Ù† â†’ Ù„ÙˆÚ©ÛŒØ´Ù† Ø¯Ù‚ÛŒÙ‚
          const delay2 = prefersReducedMotion ? 50 : Math.round(ANIM_DURATION_1 * 1000) + 400;
          setTimeout(() => {
            map.flyTo([SHOP.lat, SHOP.lng], TARGET_ZOOM, {
              animate: !prefersReducedMotion,
              duration: ANIM_DURATION_2,
              easeLinearity: 0.2
            });

            // Ù…Ø±Ø­Ù„Ù‡ 3: Ø¨Ø§Ø² Ù¾Ø§Ù¾ Ùˆ Ù…Ø®ÙÛŒ Ù„Ø§ÛŒÙ‡ Ù…Ø¹Ø±ÙÛŒ
            const delay3 = prefersReducedMotion ? 50 : Math.round(ANIM_DURATION_2 * 1000) + 300;
            setTimeout(() => {
              marker.openPopup();
              document.getElementById("intro-overlay").classList.add("hide");
              // Ø¨Ø±Ø§ÛŒ Ø¢ÛŒÙ†Ø¯Ù‡ - Ø¨Ø®Ø´ Ø§ØµÙ„ÛŒ Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¨Ø¯Û”
              // document.getElementById("main-content").classList.add("show");
            }, delay3);
          }, delay2);
        }, delay1);
      };

      // Ø±ÙˆØ´ 1: ÙˆÙ‚ØªÛŒ Ú©Ø§Ø´ÛŒâ€ŒÙ‡Ø§ Ø¨Ø§Ø± Ø´Ø¯
      tiles.once("load", runAnimation);

      // Ø±ÙˆØ´ 2: fallback - Ø§Ú¯Ø± Ø¯ÛŒØ± Ù„ÙˆØ¯ Ø´Ø¯
      setTimeout(runAnimation, 3000);

      // ØªÙˆØ§Ø¨Ø¹ Ø§Ù…Ù†ÛŒØªÛŒ
      function escapeHtml(str) {
        return String(str).replace(/[&<>"']/g, s => ({
          "&": "&amp;",
          "<": "&lt;",
          ">": "&gt;",
          '"': "&quot;",
          "'": "&#39;"
        }[s]));
      }
      function escapeAttr(str) {
        return String(str).replace(/"/g, "&quot;");
      }
    })();
  </script>
</body>
</html>